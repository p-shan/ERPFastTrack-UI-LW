"use strict";var queryConfiguration={load:function(){var t=parameterCtrl.staticDatatable.loadDataTable({title:"Query Configuration",ajaxData:null,type:"Add",identifier:"QueryConfiguration",columns:["queryName","queryDetails"]}),t=(queryConfiguration.state.addDatatable=t,parameterCtrl.staticDatatable.loadDataTable({title:"Query Configuration",ajaxData:null,type:"Edit",identifier:"QueryConfiguration",columns:["queryName","queryDetails"]})),t=(queryConfiguration.state.editDatatable=t,{title:"Query Configuration",identifier:"QueryConfiguration",type:"Add",datatable:{getInstance:function(){return"Add"==databaseConnection.state.actionType?queryConfiguration.state.addDatatable:queryConfiguration.state.editDatatable}},fields:queryConfiguration.fvFields(),customFieldMapper:function(t,n){return n}}),t=(parameterCtrl.fvAddToTable(t),{title:"Query Configuration",identifier:"QueryConfiguration",type:"Edit",datatable:{getInstance:function(){return"Add"==databaseConnection.state.actionType?queryConfiguration.state.addDatatable:queryConfiguration.state.editDatatable}},fields:queryConfiguration.fvFields(),customFieldMapper:function(t,n){return n},getRowIndex:function(){return queryConfiguration.state.rowIndex}});parameterCtrl.fvEditToTable(t),$(["#dtAddQueryConfiguration","#dtEditQueryConfiguration"]).each(function(t,n){$(n+" tbody").on("click",".delete-record",function(){var t=$(this).closest("tr");queryConfiguration.state.getDatatable().row(t).remove().draw(!1)}),$(n+" tbody").on("click",".edit-record",function(){var t=$(this).closest("tr"),t=queryConfiguration.state.getDatatable().row(t).data(),n=(queryConfiguration.state.rowIndex=queryConfiguration.state.getDatatable().row(this).index(),$("#frmEditQueryConfiguration"));n.find('input[name="queryName"]').val(t.queryName),n.find('textarea[name="queryDetails"]').val(t.queryDetails)})})},fvFields:function(){return{fields:{queryName:{validators:{notEmpty:{message:"Please enter query name"}}},queryDetails:{validators:{notEmpty:{message:"Please enter query details"}}}},plugins:parameterCtrl.fv.plugins(),init:parameterCtrl.fv.init()}},state:{rowIndex:null,editDatatable:null,addDatatable:null,getDatatable:function(){return"Add"==databaseConnection.state.actionType?queryConfiguration.state.addDatatable:queryConfiguration.state.editDatatable}}},databaseConnection={load:function(){var t={title:"Database Connection",uri:function(){return"/api/data/databaseconnection"},identifier:"DatabaseConnection",type:"Add",datatable:{getInstance:function(){return queryConfiguration.state.addDatatable},name:"QueryConfigurations"},fields:databaseConnection.fvFields(),customFieldMapper:function(t,n){return n}},t=(parameterCtrl.fvAdd(t),{title:"Database Connection",uri:function(){return"/api/data/databaseconnection/"+databaseConnection.state.editId},identifier:"DatabaseConnection",type:"Edit",datatable:{getInstance:function(){return queryConfiguration.state.editDatatable},name:"QueryConfigurations"},fields:databaseConnection.fvFields(),customFieldMapper:function(t,n){return n}});parameterCtrl.fvEdit(t);parameterCtrl.datatable.loadDataTable({title:"Database Connection",uri:function(){return"/api/data/databaseconnection"},identifier:"DatabaseConnection",columns:["id","name","connectionString"]}),$("#dtDatabaseConnection tbody").on("click",".edit-record",function(){var t=$(this).data("id"),n=$("#frmEditDatabaseConnection");$.ajax({url:"/api/data/databaseconnection/"+t,type:"GET",contentType:"application/json",success:function(t){databaseConnection.state.editId=t.id,n.find('input[name="Name"]').val(t.name),n.find('textarea[name="ConnectionString"]').val(t.connectionString),Array.isArray(t.queryConfigurations)&&queryConfiguration.state.editDatatable.rows.add(t.queryConfigurations).draw()}})}),$("#btnEdtTestConnection").on("click",function(){var t=$("#frmEditDatabaseConnection").find('textarea[name="ConnectionString"]').val();$.ajax({url:"/api/operations/utility/testconnection",data:JSON.stringify({connectionString:t}),type:"POST",contentType:"application/json",success:function(t){t.status?Swal.fire({title:"Success!",text:"Connection Successful!",icon:"success",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}):Swal.fire({title:"Error!",text:"Connection Successful. Reason"+t.errorMessage+"!",icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}})}),$("#btnAddTestConnection").on("click",function(){var t=$("#frmAddDatabaseConnection").find('textarea[name="ConnectionString"]').val();$.ajax({url:"/api/operations/utility/testconnection",data:JSON.stringify({connectionString:t}),type:"POST",contentType:"application/json",success:function(t){t.status?Swal.fire({title:"Success!",text:"Connection Successful!",icon:"success",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}):Swal.fire({title:"Error!",text:"Connection unsuccessful. Reason : "+t.errorMessage+"!",icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}})}),$("#mdlAddDatabaseConnection").on("shown.bs.modal",function(){databaseConnection.state.actionType="Add"}),$("#mdlEditDatabaseConnection").on("shown.bs.modal",function(){databaseConnection.state.actionType="Edit"}),queryConfiguration.load()},fvFields:function(){return{fields:{Name:{validators:{notEmpty:{message:"Please enter connection name"}}},ConnectionString:{validators:{notEmpty:{message:"Please enter connection string"}}}},plugins:parameterCtrl.fv.plugins(),init:parameterCtrl.fv.init()}},state:{editId:null,getEditId:function(){return databaseConnection.state.editId}}};document.addEventListener("DOMContentLoaded",function(t){databaseConnection.load()});