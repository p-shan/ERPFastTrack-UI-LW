"use strict";const driver=window.driver.js.driver;function StartPageLoader(){$.blockUI({message:'<div class="spinner-border text-white" role="status"></div>',css:{backgroundColor:"transparent",border:"0"},overlayCSS:{opacity:.5}})}function StopPageLoader(){$.unblockUI()}function getRoleBadge(t){t={ADMINISTRATOR:'<small class="text-sm"><span class="badge rounded-pill bg-label-primary">ADMINISTRATOR</span></small>',EDITOR:'<small class="text-sm"><span class="badge rounded-pill bg-label-warning m-1">EDITOR</span></small>',EXECUTOR:'<small class="text-sm"><span class="badge rounded-pill bg-label-success m-1">EXECUTOR</span></small>'}[t];return null==t?"":t}function loadGlobalOrganization(){$.ajax({url:"/api/Organization",type:"GET",contentType:"application/json",success:function(t){var e=$("#selectGlobalOrganization"),a=getCookie("selectedOrg");if(t.forEach(function(t){e.append('<option value="'+t.id+'" title="'+t.orgRole+'">'+t.organizationName+"</option>")}),null!=a&&(e.val(a),!IsIntroComplete("selected-org"))){const n=driver({showProgress:!0,steps:[{element:"#ulNavMenu li:nth-child(11)",popover:{title:"Parameter Controls",description:"Setup different data sources and it's destination. For example : Load the data from Database (SOURCE) and Write to Salesforce (DESTINATION).",side:"right",align:"start"}},{element:"#ulNavMenu li:nth-child(6)",popover:{title:"Setup Project",description:"After source and destination, start defining your project for linking source and destination connections.",side:"bottom",align:"start"}},{element:"#ulNavMenu li:nth-child(7)",popover:{title:"Setup Jobs",description:"Once project is defined, create multiple jobs to map different schemas. For Example : Map database account table to Salesforce account object.",side:"bottom",align:"start"}},{element:"#ulNavMenu li:nth-child(8)",popover:{title:"Setup Schedules",description:"Here, you can define the execution order of jobs and its schedule when to execute.",side:"bottom",align:"start"}},{element:"#ulNavMenu li:nth-child(9)",popover:{title:"Check Executions",description:"One stop to check all your executions and it's history.",side:"bottom",align:"start"}},{popover:{title:"Catch you later",description:"And that is all for now, go ahead and I will meet you later."}}],onDestroyStarted:()=>{SetIntroComplete("selected-org"),n.destroy()}});n.drive()}if(!IsIntroComplete("first-login")){const i=driver({showProgress:!0,steps:[{popover:{title:"Welcome to ERPFastTrack",description:"Let's take a tour."}},{element:"#layout-menu .menu-inner",popover:{title:"Navigation Menu",description:"Intuitive Menu for easy access of the application controls.",side:"right",align:"start"}},{element:"#ulNavMenu li:nth-child(3)",popover:{title:"Your Organizations",description:"Find all your organizations here and check their roles, license and other details.",side:"right",align:"start"}},{element:"#divGlobalOrganization",popover:{title:"Organization Selection",description:"Select your organization from here.",side:"bottom",align:"start"}},{popover:{title:"Catch you later",description:"And that is all, go ahead and I will meet you later."}}],onDestroyStarted:()=>{SetIntroComplete("first-login"),i.destroy()}});i.drive()}e.select2({placeholder:"Select an organization",dropdownParent:$("#layout-navbar"),templateSelection:function(t,e){return $(`<span>${t.text} ${getRoleBadge(t.title)}</span>`)},templateResult:function(t){return $(`<span>${t.text} ${getRoleBadge(t.title)}</span>`)}}),e.on("select2:select",function(t){setCookie("selectedOrg",t.params.data.id),location.reload()})}})}function setCookie(t,e,a){var n,i="";a&&((n=new Date).setTime(n.getTime()+24*a*60*60*1e3),i="; expires="+n.toUTCString()),document.cookie=t+"="+e+i+"; path=/"}function getCookie(t){for(const n of document.cookie.split(";").map(t=>t.trim())){var[e,a]=n.split("=");if(e===t)return a}return null}function deleteCookie(t){document.cookie=t+"=; Max-Age=-99999999;"}function isFunction(t){return"function"==typeof t&&!(null==t)}function isAvail(t){return!(null==t)}$(document).ajaxStart(StartPageLoader).ajaxStop($.unblockUI),$(document).ready(function(){$("#selectGlobalOrganization").length&&loadGlobalOrganization()}),$(function(){var t=$(".sticky-element"),e=$(".layout-navbar").height()+7;t.length&&t.sticky({topSpacing:e,zIndex:9})});var vs,fms,parameterCtrl={fvWizardAdd:function(o){o.type,o.identifier;var t="wzd"+o.type+o.identifier,e="wzd"+o.type+o.identifier+"Form",t=document.querySelector("#"+t),a=t.querySelector("#"+e),n=[].slice.call(a.querySelectorAll(".btn-next")),a=[].slice.call(a.querySelectorAll(".btn-prev"));const r=new Stepper(t,{linear:!0});vs=r;var l=[];return $.each(o.fields,function(a,i){var t="wzd"+o.type+o.identifier+"Form"+(a+1),t=FormValidation.formValidation(document.querySelector("#"+e).querySelector("#"+t),i.fvFields).on("core.form.valid",function(t){var e=!1,n={};isAvail(i.generateFormData)&&1==i.generateFormData&&$.each(t.formValidation.form.parentElement.parentElement.parentElement.parentElement,function(t,a){$.each(l,function(t,e){null!=e.fields[a.name]&&("radio"==a.type?a.checked&&(n[a.name]=a.value):"checkbox"==a.type?a.checked?n[a.name]=!0:n[a.name]=!1:n[a.name]=a.value)})}),(e=isFunction(i.postValidate)?i.postValidate(t,n,l[a],l[a+1],a,l):e)?(o.json=n,parameterCtrl.ajaxAdd(o)):r.next()});l.push(t)}),fms=l,n.forEach(t=>{t.addEventListener("click",t=>{var e=r._currentIndex;l[e].validate()})}),a.forEach(t=>{t.addEventListener("click",t=>{0!=r._currentIndex&&r.previous()})}),l},fvAddToTable:function(e){var t="frm"+e.type+e.identifier;return FormValidation.formValidation(document.getElementById(t),e.fields).on("core.form.valid",function(a){var n={},t=[],t=($.each(a.formValidation.form,function(t,e){null!=a.formValidation.fields[e.name]&&("radio"==e.type?e.checked&&(n[e.name]=e.value):"checkbox"==e.type?e.checked?n[e.name]=!0:n[e.name]=!1:n[e.name]=e.value)}),null!=e.customFieldMapper&&null!=e.customFieldMapper&&(n=e.customFieldMapper(a,n)),t.push(n),e.datatable.getInstance().rows.add(t).draw(),$("#ocAdd"+e.identifier).offcanvas("hide"),"frm"+e.type+e.identifier);$("#"+t).trigger("reset")})},fvEditToTable:function(e){var t="frm"+e.type+e.identifier;return FormValidation.formValidation(document.getElementById(t),e.fields).on("core.form.valid",function(a){var n={},t=($.each(a.formValidation.form,function(t,e){null!=a.formValidation.fields[e.name]&&("radio"==e.type?e.checked&&(n[e.name]=e.value):"checkbox"==e.type?e.checked?n[e.name]=!0:n[e.name]=!1:n[e.name]=e.value)}),null!=e.customFieldMapper&&null!=e.customFieldMapper&&(n=e.customFieldMapper(a,n)),e.datatable.getInstance().row(e.getRowIndex()).data(n).draw(),$("#ocEdit"+e.identifier).offcanvas("hide"),"frm"+e.type+e.identifier);$("#"+t).trigger("reset")})},fvAdd:function(t){var e="frm"+t.type+t.identifier;return FormValidation.formValidation(document.getElementById(e),t.fields).on("core.form.valid",function(a){var n={};$.each(a.formValidation.form,function(t,e){null!=a.formValidation.fields[e.name]&&("radio"==e.type?e.checked&&(n[e.name]=e.value):"checkbox"==e.type?e.checked?n[e.name]=!0:n[e.name]=!1:n[e.name]=e.value)}),isAvail(t.datatable)&&(n[t.datatable.name]=t.datatable.getInstance().rows().data().toArray()),null!=t.customFieldMapper&&null!=t.customFieldMapper&&(n=t.customFieldMapper(a,n)),t.json=n,parameterCtrl.ajaxAdd(t)})},fvEdit:function(t){var e="frm"+t.type+t.identifier;return FormValidation.formValidation(document.getElementById(e),t.fields).on("core.form.valid",function(a){var n={};$.each(a.formValidation.form,function(t,e){null!=a.formValidation.fields[e.name]&&("radio"==e.type?e.checked&&(n[e.name]=e.value):"checkbox"==e.type?e.checked?n[e.name]=!0:n[e.name]=!1:n[e.name]=e.value)}),isAvail(t.datatable)&&(n[t.datatable.name]=t.datatable.getInstance().rows().data().toArray()),null!=t.customFieldMapper&&null!=t.customFieldMapper&&(n=t.customFieldMapper(a,n)),t.json=n,parameterCtrl.ajaxEdit(t)})},ajaxEdit:function(a,t,e){$.ajax({url:a.uri(),type:"PUT",contentType:"application/json",data:JSON.stringify(a.json),success:function(t){var e;t.status?(Swal.fire({title:"Success!",text:a.title+" changes have been saved!",icon:"success",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}).then(()=>{$("#dt"+a.identifier).DataTable().ajax.reload()}),$("#mdlEdit"+a.identifier).modal("hide"),e="frm"+a.type+a.identifier,$("#"+e).trigger("reset"),isAvail(a.datatable)&&a.datatable.getInstance().clear().draw()):Swal.fire({title:"Error!",text:"There was an error while saving "+a.title+" - "+t.errorMessage,icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},error:function(t){Swal.fire({title:"Error!",text:"There was an error while saving "+a.title+"!",icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}})},ajaxAdd:function(a,t,e){$.ajax({url:a.uri(),type:"POST",contentType:"application/json",data:JSON.stringify(a.json),success:function(t){var e;t.status?(Swal.fire({title:"Success!",text:a.title+" has been created!",icon:"success",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}).then(()=>{$("#dt"+a.identifier).DataTable().ajax.reload()}),$("#mdlAdd"+a.identifier).modal("hide"),e="frm"+a.type+a.identifier,$("#"+e).trigger("reset"),isAvail(a.datatable)&&a.datatable.getInstance().clear().draw()):Swal.fire({title:"Error!",text:"There was an error while adding "+a.title+" - "+t.errorMessage,icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},error:function(t){Swal.fire({title:"Error!",text:"There was an error while adding "+a.title+"!",icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}})},loadSection:function(t){var e=document.getElementById("hbs"+t.identifier).innerHTML,e=Handlebars.compile(e);$("#hbsOutersection"+t.identifier).html(e(t.data))},loadSectionWithCallbacks:function(t){var e;t.isIteratable||(e=document.getElementById("hbs"+t.identifier).innerHTML,e=Handlebars.compile(e),(isAvail(t.parentIdentifier)?$(t.parentIdentifier):$("#hbsOutersection"+t.identifier)).html(e(isFunction(t.data)?t.data():null)),isFunction(t.postLoad)&&t.postLoad())},unloadSectionWithCallbacks:function(t){$("#hbsOutersection"+t.identifier).html(""),isFunction(t.postUnload)&&t.postUnload()},selectAjaxPost:function(o,t,e){$.ajax({url:o.uri,data:JSON.stringify(o.data),type:"POST",contentType:"application/json",success:function(i){Array.isArray(i.data)&&0<i.data.length?(o.fields.forEach(function(t,e){var n=$(t.selIdentifier),a=(t.destroyAtStart&&n.select2("destroy"),n.empty(),$("<option/>"));n.append(a),i.data.forEach(function(e){var a;isFunction(t.title)?(a=$("<option/>",{value:e[t.resKey],title:t.title(e)}).text(e[t.resValue]),Array.isArray(t.attributes)&&0<t.attributes.length&&t.attributes.forEach(function(t){a.data(t.key,e[t.value])})):(a=$("<option/>",{value:e[t.resKey]}).text(e[t.resValue]),Array.isArray(t.attributes)&&0<t.attributes.length&&t.attributes.forEach(function(t){a.data(t.key,t.value)})),n.append(a)}),isAvail(t.form)&&n.on("change",function(){t.form.revalidateField(t.name)}),isFunction(t.changeEvent)&&n.on("change",t.changeEvent),isFunction(t.template)?n.select2({placeholder:"Select an "+o.title,dropdownParent:$(t.parentIdentifier),templateResult:t.template,dropdownCssClass:"auto-height"}):n.select2({placeholder:"Select an "+o.title,dropdownParent:$(t.parentIdentifier),dropdownCssClass:"auto-height"})}),isFunction(t)&&t(i)):isFunction(e)&&e(i)}})},selectAjax:function(o,t,e){$.ajax({url:o.uri,type:"GET",contentType:"application/json",success:function(i){Array.isArray(i.data)&&0<i.data.length?(o.fields.forEach(function(t,e){var n=$(t.selIdentifier),a=(t.destroyAtStart&&n.select2("destroy"),n.empty(),$("<option/>"));n.append(a),i.data.forEach(function(e){var a;isFunction(t.title)?(a=$("<option/>",{value:e[t.resKey],title:t.title(e)}).text(e[t.resValue]),Array.isArray(t.attributes)&&0<t.attributes.length&&t.attributes.forEach(function(t){a.data(t.key,e[t.value])})):(a=$("<option/>",{value:e[t.resKey]}).text(e[t.resValue]),Array.isArray(t.attributes)&&0<t.attributes.length&&t.attributes.forEach(function(t){a.data(t.key,t.value)})),n.append(a)}),isAvail(t.form)&&n.on("change",function(){t.form.revalidateField(t.name)}),isFunction(t.changeEvent)&&n.on("change",t.changeEvent),isFunction(t.template)?n.select2({placeholder:"Select an "+o.title,dropdownParent:$(t.parentIdentifier),templateResult:t.template,dropdownCssClass:"auto-height"}):n.select2({placeholder:"Select an "+o.title,dropdownParent:$(t.parentIdentifier),dropdownCssClass:"auto-height"})}),isFunction(t)&&t(i)):isFunction(e)&&e(i)}})},staticDatatable:{loadDataTable:function(i){return $("#dt"+i.type+i.identifier).DataTable({dom:'<"row mx-1"<"col-sm-12 col-md-3" l><"col-sm-12 col-md-9"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-md-end justify-content-center flex-wrap me-1"<"me-3"f>B>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',data:i.ajaxData,columns:parameterCtrl.staticDatatable.columns(i.columns),buttons:isFunction(i.buttonFunc)?i.buttonFunc():parameterCtrl.staticDatatable.buttons("Add","#ocAdd"+i.identifier),columnDefs:[{targets:-1,searchable:!1,title:"Actions",orderable:!1,render:function(t,e,a,n){return'<span class="text-nowrap"><span class="btn btn-sm btn-icon me-2 edit-record" data-id="'+a.id+'" data-bs-target="#ocEdit'+i.identifier+'" data-bs-toggle="offcanvas"><i class="ti ti-edit"></i></span><span class="btn btn-sm btn-icon delete-record" data-id="'+a.id+'"><i class="ti ti-trash"></i></span></span>'}}]})},columns:function(t){let e=[];return t.forEach(t=>{e.push({data:t})}),e.push(""),e},buttons:function(t,e){return[{text:t,className:"add-new btn btn-primary mb-3 mb-md-0",attr:{"data-bs-toggle":"offcanvas","data-bs-target":e},init:function(t,e,a){$(e).removeClass("btn-secondary")}}]}},datatable:{loadDataTable:function(i){var e=[];isAvail(i.isResponsiveDisabled)&&i.isResponsiveDisabled||e.push({className:"control",orderable:!1,searchable:!1,visible:!1,responsivePriority:2,targets:0,render:function(t,e,a,n){return""}}),e.push({targets:1,searchable:!1,visible:!1}),isAvail(i.isActionHidden)&&i.isActionHidden||e.push({targets:-1,searchable:!1,title:"Actions",orderable:!1,render:function(t,e,a,n){return isFunction(i.customActionColumnRender)?i.customActionColumnRender(t,e,a,n):'<span class="text-nowrap"><button class="btn btn-sm btn-icon me-2 edit-record" data-id="'+a.id+'" data-bs-target="#mdlEdit'+i.identifier+'" data-bs-toggle="modal" data-bs-dismiss="modal"><i class="ti ti-edit"></i></button><button class="btn btn-sm btn-icon delete-record" data-id="'+a.id+'"><i class="ti ti-trash"></i></button></span>'}}),isAvail(i.customColumnDefs)&&0<i.customColumnDefs.length&&i.customColumnDefs.forEach(function(t){e.push(t)}),$("#dt"+i.identifier).on("error.dt",function(t,e,a,n){toastr.options.progressBar=!0,toastr.warning(i.title+" - no data exists !")}).DataTable({ajax:{url:i.uri(),dataSrc:function(t){return null!=t.data?t.data:null==i.data?[]:t[i.data]},complete:function(t){isFunction(i.successCb)&&i.successCb(i)}},rowCallback:isFunction(i.customRowCallback)?i.customRowCallback:function(t,e,a){},columns:parameterCtrl.datatable.columns(i.columns),columnDefs:isAvail(i.isColumnDefDisabled)&&i.isColumnDefDisabled?null:e,order:parameterCtrl.datatable.order,dom:(isAvail(i.dom)?i:parameterCtrl.datatable).dom,language:parameterCtrl.datatable.language,buttons:isFunction(i.buttonFunc)?i.buttonFunc():parameterCtrl.datatable.buttons("Add New "+i.title,"#mdlAdd"+i.identifier),responsive:isAvail(i.isResponsiveDisabled)&&i.isResponsiveDisabled?null:parameterCtrl.datatable.responsive(),initComplete:function(){isFunction(i.completeFunc)&&i.completeFunc()}}),$("#dt"+i.identifier+" tbody").on("click",".delete-record",isFunction(i.deleteFunc)?i.deleteFunc():function(){var e=$(this).data("id");Swal.fire({title:"Delete record?",text:"Do you want to delete this record?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1}).then(t=>{t.isConfirmed&&$.ajax({url:isFunction(i.deleteUri)?i.deleteUri()+"/"+e:i.uri()+"/"+e,type:"DELETE",contentType:"application/json",success:function(t){Swal.fire({title:"Success!",icon:"success",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}).then(()=>{$("#dt"+i.identifier).DataTable().ajax.reload()})},error:function(t){Swal.fire({title:"Error!",text:"There was an error while deleting "+i.title+"!",icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}})})}),setTimeout(()=>{$(".dataTables_filter .form-control").removeClass("form-control-sm"),$(".dataTables_length .form-select").removeClass("form-select-sm")},300)},order:[[1,"asc"]],dom:'<"row mx-1"<"col-sm-12 col-md-3" l><"col-sm-12 col-md-9"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-md-end justify-content-center flex-wrap me-1"<"me-3"f>B>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"Show _MENU_",search:"Search",searchPlaceholder:"Search.."},buttons:function(t,e){return[{text:t,className:"add-new btn btn-primary mb-3 mb-md-0",attr:{"data-bs-toggle":"modal","data-bs-target":e},init:function(t,e,a){$(e).removeClass("btn-secondary")}},{text:"Refresh",className:"add-new btn btn-warning mb-3 ms-1 mb-md-0",action:function(t,e,a,n){e.clear().draw(),e.ajax.reload()}}]},responsive:function(){return{details:{display:$.fn.dataTable.Responsive.display.modal({header:function(t){return"Details of "+t.data().name}}),type:"column",renderer:function(t,e,a){a=$.map(a,function(t,e){return""!==t.title?'<tr data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><td>'+t.title+":</td> <td>"+t.data+"</td></tr>":""}).join("");return!!a&&$('<table class="table"/><tbody />').append(a)}}}},columns:function(t){let e=[];return e.push(""),t.forEach(t=>{e.push({data:t})}),e.push(""),e}},fv:{plugins:function(){return{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".form-field"}),submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus}},init:function(){return t=>{t.on("plugins.message.placed",function(t){t.element.parentElement.classList.contains("input-group")&&t.element.parentElement.insertAdjacentElement("afterend",t.messageElement)})}}},fvWizard:{plugins:function(){return{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5,submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus}}}};function ExtractDate(t){return isAvail(t)?t.split("T")[0]:""}function IsIntroComplete(t){return"1"==localStorage.getItem("intro_"+t)}function SetIntroComplete(t){localStorage.setItem("intro_"+t,"1")}isAvail($.fn.dataTable)&&($.fn.dataTable.ext.errMode="none"),Handlebars.registerHelper("eq",function(t,e,a){return t===e});